#!/usr/bin/env bash

icon_dir="$HOME/.config/dunst/assets"

_step="2"
_timeout="1200"

_backlight() {
	local bkl=$(brightnessctl g)
	echo "$bkl" > /dev/null
}

_icons() {
	local bkl=$(_backlight)

	if [ "$bkl" -le "20" ]; then
		echo "$icon_dir/brightness.svg"
	elif [ "$bkl" -le "40" ]; then
		echo "$icon_dir/brightness.svg"
	elif [ "$bkl" -le "60" ]; then
		echo "$icon_dir/brightness.svg"
	elif [ "$bkl" -le "80" ]; then
		echo "$icon_dir/brightness.svg"
	else
		echo "$icon_dir/brightness.svg"
	fi
}

_notify() {
  notify-send -e -r 91190 -t $_timeout -h int:value:"$(_backlight)" -h string:x-canonical-private-synchronous:brightness_notif -u normal -i "$(_icons)" "$(_backlight)%"
}

_inc() {
	brightnessctl set "+$_step%" > /dev/null
	_notify
}

_dec() {
	brightnessctl set "$_step%-" -n > /dev/null
	_notify
}

_help() {
  cat << HELP
Usage: $0 [options]

Options:
  --get,            - Get current screen brightness level
  --inc,            - Increase screen brightness
  --dec,            - Decrese screen brightness
  --help, -h        - Show this help message
HELP
}

case "$1" in
  --get)
  	_backlight
  	;;
  --inc)
  	_inc
  	;;
  --dec)
  	_dec
  	;;
  --help|-h)
    _help
    exit 0
    ;;
 esac
