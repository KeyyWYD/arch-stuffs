#!/usr/bin/env bash

icon_dir="$HOME/.config/dunst/assets"

get_backlight() {
	echo $(brightnessctl -m | cut -d, -f4)
}

get_icon() {
	current=$(get_backlight | sed 's/%//')
	if   [ "$current" -le "20" ]; then
		icon="$icon_dir/brightness.svg"
	elif [ "$current" -le "40" ]; then
		icon="$icon_dir/brightness.svg"
	elif [ "$current" -le "60" ]; then
		icon="$icon_dir/brightness.svg"
	elif [ "$current" -le "80" ]; then
		icon="$icon_dir/brightness.svg"
	else
		icon="$icon_dir/brightness.svg"
	fi
}

notify_user() {
	notify-send -e -h string:x-canonical-private-synchronous:brightness_notif -h int:value:$current -u low -i "$icon" "$current%"
}

change_backlight() {
	brightnessctl set "$1" -n && get_icon && notify_user
}

case "$1" in
  --get)
  	get_backlight
  	;;
  --inc)
  	change_backlight "+2%"
  	;;
  --dec)
  	change_backlight "2%-"
  	;;
  *)
  	get_backlight
  	;;
esac
